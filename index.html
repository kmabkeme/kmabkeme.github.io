<!DOCTYPE html>
<html>
	<head>
    	<meta charset="utf-8">
    	<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
		<title>Roth IRA Conversion Calculator</title>

		<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.2/css/bootstrap.min.css" integrity="sha384-Smlep5jCw/wG7hdkwQ/Z5nLIefveQRIY9nfy6xoR1uRYBtpZgI6339F5dgvm/e9B" crossorigin="anonymous">

		<link rel="stylesheet" href="css/mystyles.css">
		<style>
			input {
    			width: 200px;
			}	
		</style>

	</head> 
	<body>

		<div class="container">
  			<h1>Roth IRA Conversion Calculator</h1>
  			<p>Is it worth it to do a "backdoor" conversion from a traditional IRA to a Roth IRA? Will paying taxes today on converted funds lead to better future returns?</p> 
		</div>

		<div class="container">
			<form>
				<div class="row" style="border:3px solid #cecece;">
					<div class="col-sm">
						<label for="tax-filing-status">Federal tax filing status:</label><br  />

						<div id="tax-filing-status" class="btn-group-vertical btn-group-toggle" data-toggle="buttons">
  							<label class="btn btn-secondary" onclick="hideOtherTaxFilingStatuses('single');">
    							<input type="radio" name="options" id="single" autocomplete="off" checked> Single
  							</label>
  							<label class="btn btn-secondary" onclick="hideOtherTaxFilingStatuses('marriedFilingJointly');">
    							<input type="radio" name="options" id="marriedFilingJointly" autocomplete="off"> Married, filing jointly
  							</label>
  							<label class="btn btn-secondary" onclick="hideOtherTaxFilingStatuses('marriedFilingSeparately');">
    							<input type="radio" name="options" id="marriedFilingSeparately" autocomplete="off"> Married, filing separately
  							</label>
  							<label class="btn btn-secondary" onclick="hideOtherTaxFilingStatuses('headHousehold');">
    							<input type="radio" name="options" id="headHousehold" autocomplete="off"> Head of household
  							</label>
						</div>
					</div>

				 	<div class="col-sm">

				 		<label for="income-range">Adjusted Gross Income for 2018:</label><br />

						<div id="incomeDIV" >

		  					<div id="income-range" class="panel-body">
								<button type="button" id="btn10" class="btn btn-secondary rounded-0" data-toggle="button" onclick="hideOtherIncomes('btn12','btn22','btn24','btn32','btn35','btn37');marginalTaxRate.value = '10';"> 0 to $9,525 </button>

								<button type="button" id="btn12" class="btn btn-secondary rounded-0" data-toggle="button" onclick="hideOtherIncomes('btn10','btn22','btn24','btn32','btn35','btn37');marginalTaxRate.value = '12';"> $9,525 to $38,700 </button>

								<button type="button" id="btn22" class="btn btn-secondary rounded-0" data-toggle="button" onclick="hideOtherIncomes('btn10','btn12','btn24','btn32','btn35','btn37');marginalTaxRate.value = '22';"> $38,700 to $82,500 </button>

 								<button type="button" id="btn24" class="btn btn-secondary rounded-0" data-toggle="button" onclick="hideOtherIncomes('btn10','btn12','btn22','btn32','btn35','btn37');marginalTaxRate.value = '24';"> $82,500 to $157,500 </button>

								<button type="button" id="btn32" class="btn btn-secondary rounded-0" data-toggle="button" onclick="hideOtherIncomes('btn10','btn12','btn22','btn24','btn35','btn37');marginalTaxRate.value = '32';"> $157,500 to $200,000 </button>

 								<button type="button" id="btn35" class="btn btn-secondary rounded-0" data-toggle="button" onclick="hideOtherIncomes('btn10','btn12','btn22','btn24','btn32','btn37');marginalTaxRate.value = '35';"> $200,000 to $500,000 </button>

 								<button type="button" id="btn37" class="btn btn-secondary rounded-0" data-toggle="button" onclick="hideOtherIncomes('btn10','btn12','btn22','btn24','btn32','btn35');marginalTaxRate.value = '37';"> Over $500,000 </button>
		  					</div>

	  					</div>
	  					<div class="row">
								<br />
						</div>

	  				</div>

	  				<div class="col-sm">

		  				<div class="form-group">
					    	<label for="marginalTaxRate">Marginal Tax Rate for 2018</label>
					    	<div class="input-group">
					    		<input type="number" max="37" min="10" class="form-control col-2" id="marginalTaxRate" value="24"readonly>
					    		<div class="input-group-append">
		      						<div class="input-group-text">%</div>
		    					</div>
					    	</div>
						</div>


						<br />

		  				<div class="form-group">
					    	<label for="formEstFutureTaxRate" id="futureTaxLabel">Estimated federal income tax rate at time of first withdrawal</label>
					    	<div class="input-group">
					    		<input type="number" max="50" min="0" class="form-control col-2" id="formEstFutureTaxRate" value="15">
					    		<div class="input-group-append">
		      						<div class="input-group-text">%</div>
		    					</div>
					    	</div>
						</div>


					</div>

				</div>

  				<!--Do onsubmit = "return false" if I have problems with the form fields resetting after submit-->

				<br />

				<div class="row" style="border:3px solid #cecece;">
					<div class="col-sm">
						<div class="btn-group-toggle" data-toggle="buttons">
							<label for="anyStateTaxes">Would you like to include state taxes in your calculation?</label><br />
		  					<label class="btn btn-secondary active">
		    					<input type="checkbox" checked autocomplete="off" id="anyStateTaxes" onchange="toggler('StateTaxesDIV');">
		    					    <span class="label-yes">Yes</span>
		    						<span class="label-no">No</span>
		  					</label>
						</div>
						<div class="row">
								<br />
						</div>
					</div>

					<div class="col-sm">
						<div id="StateTaxesDIV" class="hidden">
							<div class="form-group">
						    	<label for="formStateTaxRateToday">Your state tax rate for 2018</label>
						    	<div class="input-group">
						    		<input type="number" min="0" class="form-control col-4" id="formStateTaxRateToday">
						    		<div class="input-group-append">
		      							<div class="input-group-text">%</div>
		    						</div>
						    	</div>
						  	</div>


							<div class="form-group">
						    	<label for="formStateTaxRateFuture">Estimated state tax rate at time of first withdrawal</label>
						    	<div class="input-group">
						    		<input type="number" min="0" class="form-control col-4" id="formStateTaxRateFuture">
						    		<div class="input-group-append">
		      							<div class="input-group-text">%</div>
		    						</div>
						    	</div>
							</div>  			
					  	</div>
				  	</div>	
			  	</div>

			  	<br />

				<div class="row" style="border:3px solid #cecece;">
					<div class="col-sm">
						<div class="btn-group-toggle" data-toggle="buttons">
							<label for="anyNondeductIRA">Have you made any nondeductible contributions to your Traditional IRA?</label><br />
		  					<label class="btn btn-secondary active">
		    					<input type="checkbox" checked autocomplete="off" id="anyNondeductIRA" onchange="toggler('NonDeductIRADIV');">
		    					    <span class="label-yes">Yes</span>
		    						<span class="label-no">No</span>
		  					</label>
						</div>
						<div class="row">
								<br />
						</div>
					</div>

					<div class="col-sm">
						<div id="NonDeductIRADIV" class="hidden">
							<div class="form-group">
						    	<label for="formNondeductibleIRA">Amount of non-deductible contributions to IRAs (i.e., you already paid taxes on these)</label>
						    	<div class="input-group">
					    	    	<div class="input-group-prepend">
		      							<div class="input-group-text">$</div>
		    						</div>
						    		<input type="number" min="1" class="form-control col-4" id="formNondeductibleIRA">
						    	</div>
						  	</div>


							<div class="form-group">
						    	<label for="formNonRothIRAValue">Combined value of all your non-Roth IRAs, both deductible and non-deductible</label>
						    	<div class="input-group">
						    	    <div class="input-group-prepend">
			      						<div class="input-group-text">$</div>
			    					</div>
						    		<input type="number" min="0" class="form-control col-4" id="formNonRothIRAValue">
						    	</div>
							</div>  			
					  	</div>
				  	</div>	
			  	</div>

			  	<br />

			  	<div class="row" style="border:3px solid #cecece;">
					<div class="col-sm">

					  	<div class="form-group">
					    	<label for="formConvertValue">Amount of IRA that you would like to convert to Roth IRA:</label>
					    	<div class="input-group">
					    	    <div class="input-group-prepend">
		      						<div class="input-group-text">$</div>
		    					</div>
					    		<input type="number" min="1" class="form-control col-4" id="formConvertValue" value="1000" required>
					    	</div>
						</div>

						<div class="form-group">
					    	<label for="formYears">Number of years before you expect to start withdrawing funds:</label>
					    	<div class="input-group">
					    		<input type="number" min="1" max="50" class="form-control col-2" id="formYears" value="20" required>
					    		<div class="input-group-append">
		      						<div class="input-group-text">years</div>
		    					</div>
					    	</div>
						</div>
					</div>
					<div class="col-sm">

						<label for="interest-rate">Select your investment risk profile and likely annual rate of return:</label>
						<br />

						<div id="interest-rate" class="btn-group-vertical btn-group-toggle" data-toggle="buttons">
		  					<label class="btn btn-secondary" onclick="investIntRate.value = '2.5';">
		    					<input type="radio" name="options2" id="rate2.5" autocomplete="off" checked> Short-term - 2.5%
		  					</label>
		  					<label class="btn btn-secondary" onclick="investIntRate.value = '3.5';">
		    					<input type="radio" name="options2" id="rate3.5" autocomplete="off"> Conservative - 3.5%
		  					</label>
		  					<label class="btn btn-secondary" onclick="investIntRate.value = '4.4';">
		    					<input type="radio" name="options2" id="rate4.4" autocomplete="off"> Moderately Conservative - 4.4%
		  					</label>
		  					<label class="btn btn-secondary" onclick="investIntRate.value = '5.2';">
		    					<input type="radio" name="options2" id="rate5.2" autocomplete="off"> Moderate - 5.2% 
		  					</label>
		  					<label class="btn btn-secondary" onclick="investIntRate.value = '6.0';">
		    					<input type="radio" name="options2" id="rate6.0" autocomplete="off"> Moderately Aggressive - 6.0% 
		  					</label>
		  					<label class="btn btn-secondary" onclick="investIntRate.value = '6.6';">
		    					<input type="radio" name="options2" id="rate6.6" autocomplete="off"> Aggressive - 6.6% 
		  					</label>
						</div>
						<div class="row">
								<br />
						</div>
					</div>
					<div class="col-sm">

						<div class="form-group">
					    	<label for="investIntRate">Likely Rate of Return:</label>
					    	<div class="input-group">
					    		<input type="number" max="7" min="0" class="form-control col-3" id="investIntRate" value="2.5" readonly>
					    		<div class="input-group-append">
		      						<div class="input-group-text">%</div>
		    					</div>
					    	</div>
						</div>
					</div>
				</div>

				<br />

 
				<div id="submitDIV">
  					<button type="button" class="btn btn-secondary" onclick="calculateAndDisplay();">Calculate</button>
  				</div>

  				<br />

  			</form>
  		</div> 				

  		<div class="container">
  			<br />

			<div class="alert alert-warning hidden" role="alert" id="futureTaxAlert">
  				Please enter a number between 0 and 50 for Estimated federal income tax rate at time of first withdrawal.
  				<button type="button" class="close" aria-label="Close" onclick="$('#futureTaxAlert').hide();">
    			<span aria-hidden="true">&times;</span>
  				</button>
			</div>

			<div class="alert alert-warning hidden" role="alert" id="stateTaxAlert">
  				Please enter a number between 1 and 50 for each of the present and future state tax rates.
  				<button type="button" class="close" aria-label="Close" onclick="$('#stateTaxAlert').hide();">
    			<span aria-hidden="true">&times;</span>
  				</button>
			</div>

			<div class="alert alert-warning hidden" role="alert" id="IRAAlert">
  				Please enter a number between 1 and 1000000 for both the nondeductible and total IRA values.
  				<button type="button" class="close" aria-label="Close" onclick="$('#IRAAlert').hide();">
    			<span aria-hidden="true">&times;</span>
  				</button>
			</div>

			<div class="alert alert-warning hidden" role="alert" id="amtConvertAlert">
  				Please enter a number between 1 and 1000000 for the Amount of IRA that you want to convert to a Roth IRA.
  				<button type="button" class="close" aria-label="Close" onclick="$('#amtConvertAlert').hide();">
    			<span aria-hidden="true">&times;</span>
  				</button>
			</div>

			<div class="alert alert-warning hidden" role="alert" id="yearsAlert">
  				Please enter a number between 1 and 50 for the Number of years before you expect to start withdrawing funds.
  				<button type="button" class="close" aria-label="Close" onclick="$('#yearsAlert').hide();">
    			<span aria-hidden="true">&times;</span>
  				</button>
			</div>
		</div>

		<script>
			function validateFunction() {

				var validFlag = true;

 				// No need to check on the 2018 marginal tax rate, because that is selected by radio buttons
 				// and thus will always have a valid value.

 				// First, make sure there's a valid value in the future tax rate field. 
 				// If not, then let's show an alert and return false so that we don't plot something wonky.
 				var margTaxRateFuture = document.getElementById('formEstFutureTaxRate').value;

 				if (isNaN(margTaxRateFuture) || margTaxRateFuture < 0 || margTaxRateFuture > 50)
 				{
 					$('#futureTaxAlert').show();
 					validFlag = false;
 				}

 				// The state tax rates and deductible/nondeductible IRA amounts aren't required, so I check for
 				// matched pairs of vslues in calculateAndDisplay(). But I guess I should give a warning if there
 				// isn't a matched set of each

 				var stateTaxRateToday = document.getElementById('formStateTaxRateToday').value;
    			var stateTaxRateFuture = document.getElementById('formStateTaxRateFuture').value;

    			if (stateTaxRateToday == '' && stateTaxRateFuture == ''){
    				// Do nothing if both fields are empty, because this situation is OK
    			}
    			else if (isNaN(stateTaxRateToday) || stateTaxRateToday < 1 || stateTaxRateToday > 50 || !isNaN(stateTaxRateFuture) || stateTaxRateFuture < 1 || stateTaxRateFuture > 50) {

 					$('#stateTaxAlert').show();
 					validFlag = false;
    			}

    			// The amounts in the nondeductible IRAs and total amounts in IRAs have to both have values or else
    			// they aren't used.
    			var totalIRAValue = document.getElementById('formNonRothIRAValue').value;
    			var nondeductIRAValue = document.getElementById('formNondeductibleIRA').value;

    			if (totalIRAValue == '' && nondeductIRAValue == ''){
    				// Do nothing if both fields are empty, because this situation is OK
    			}
    			else if (isNaN(totalIRAValue) || totalIRAValue < 1 || totalIRAValue > 1000000 || totalIRAValue < nondeductIRAValue || !isNaN(nondeductIRAValue) || nondeductIRAValue < 1 || nondeductIRAValue > 1000000) {

 					$('#IRAAlert').show();
 					validFlag = false;
    			}

    			// Total value of IRA funds to convert

 			  	var amtToConvert = document.getElementById('formConvertValue').value;

 			  	if (isNaN(amtToConvert) || amtToConvert < 1 || amtToConvert > 1000000)
 				{
 					$('#amtConvertAlert').show();
 					validFlag = false;
 				}

 				// Validate the number of years entered
 				var years = document.getElementById('formYears').value;

 			  	if (isNaN(years) || years < 1 || years > 50)
 				{
 					$('#yearsAlert').show();
 					validFlag = false;
 				}

  				return validFlag;
			}
		</script>

		<div class="container">
				<div>
					Final value of Roth IRA conversion: <strong>$<output id="finalRothIRA"></output></strong>
				</div>

				<div>
					Final value if funds left in traditional IRA: <strong>$<output id="finalTradIRA"></output></strong>
				</div>

				<div>
					Final value of investing the money that would have gone to taxes for the IRA conversion: <strong>$<output id="finalTaxesIRANonConvert"></output></strong>
				</div>
		</div>

		<!--<div class="container" style="position: relative; height:20vh; width:40vw">-->
		<!--<div class="container" style="position: relative; height:90vh; width:90vw">-->
			<canvas id="myChart"></canvas>
		<!--</div>-->

		<div class="container">

			<button class="btn btn-primary btn-lg" onclick="testFun('testId')" data-toggle="modal" data-target="#myModal">
			  Launch demo modal
			</button>
			<div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
			  <div class="modal-dialog">
			    <div class="modal-content">
			      <div class="modal-header">
			        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
			        <h4 class="modal-title" id="myModalLabel">Modal title</h4>
			      </div>
			      <div class="modal-body">
			        <h1 id="testH1"></h1>
			      </div>
			      <div class="modal-footer">
			        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
			        <button type="button" class="btn btn-primary">Save changes</button>
			      </div>
			    </div>
			  </div>
			</div>
		</div>

		<div class="container">
			<button class="btn btn-success" onclick="$(this).hide();"> Click me! </button>
		</div>

	
     	<script>
 			function testFun(variable){

				document.getElementById('testH1').innerHTML=document.getElementById("formGroupExampleInput2").value;
			}

			function hideOtherTaxFilingStatuses(taxStatusPicked) {

				var btn10Text;
				var btn12Text;
				var btn22Text;
				var btn24Text;
				var btn32Text;
				var btn35Text;
				var btn37Text;

				var incomeStr = 'divIncome'

				switch (taxStatusPicked) {

					case 'single':
						btn10Text = '0 to $9,525';
						btn12Text = '$9,525 to $38,700';
						btn22Text = '$38,700 to $82,500';
						btn24Text = '$82,500 to $157,500';
						btn32Text = '$157,500 to $200,000';
						btn35Text = '$200,000 to $500,000';
						btn37Text = 'Over $500,000';
						break;
					case 'marriedFilingJointly':
						btn10Text = '0 to $19,050';
						btn12Text = '$19,050 to $77,400';
						btn22Text = '$77,400 to $165,000';
						btn24Text = '$165,000 to $315,000';
						btn32Text = '$315,000 to $400,000';
						btn35Text = '$400,000 to $600,000';
						btn37Text = 'Over $600,000';
						break;
					case 'marriedFilingSeparately':
						btn10Text = '0 to $9,525';
						btn12Text = '$9,525 to $38,700';
						btn22Text = '$38,700 to $82,500';
						btn24Text = '$82,500 to $157,500';
						btn32Text = '$157,500 to $200,000';
						btn35Text = '$200,000 to $500,000';
						btn37Text = 'Over $500,000';
						break;
					case 'headHousehold':
						btn10Text = '0 to $13,600';
						btn12Text = '$13,600 to $51,800';
						btn22Text = '$51,800 to $82,500';
						btn24Text = '$82,500 to $157,500';
						btn32Text = '$157,500 to $200,000';
						btn35Text = '$200,000 to $500,000';
						btn37Text = 'Over $500,000';
						break;
				}

				document.getElementById('btn10').innerText = btn10Text;
				document.getElementById('btn12').innerText = btn12Text;
				document.getElementById('btn22').innerText = btn22Text;
				document.getElementById('btn24').innerText = btn24Text;
				document.getElementById('btn32').innerText = btn32Text;
				document.getElementById('btn35').innerText = btn35Text;
				document.getElementById('btn37').innerText = btn37Text;

				// Reset the marginal tax rate value to 10% so it never has a blank value
				document.getElementById('marginalTaxRate').value='10';

			}

			function hideOtherIncomes(btn1, btn2, btn3, btn4, btn5, btn6) {
				var incomeStr = 'divIncome'
				disableOneThing(btn1);
				disableOneThing(btn2);
				disableOneThing(btn3);
				disableOneThing(btn4);
				disableOneThing(btn5);
				disableOneThing(btn6);
			}

			function hideOneThing(thingToHide) {
    			var x = document.getElementById(thingToHide);
    			if (x.style.display === "none") {
        			x.style.display = "block";
    			} else {
        			x.style.display = "none";
    			}
			}

			function disableOneThing(thingToDisable) {
    			var x = document.getElementById(thingToDisable);
    			if (x.disabled === true) {
        			document.getElementById(thingToDisable).disabled = false;
    			} else {
        			document.getElementById(thingToDisable).disabled = true;
    			}
			}

			function showOneThing(thingToShow) {
    			var x = document.getElementById(thingToShow);
        		x.style.display = "block";
			}

			function calculateAndDisplay() {
    			var margTaxRateToday = document.getElementById('marginalTaxRate').value;
    			var margTaxRateFuture = document.getElementById('formEstFutureTaxRate').value;

    			var stateTaxRateToday = document.getElementById('formStateTaxRateToday').value;
    			var stateTaxRateFuture = document.getElementById('formStateTaxRateFuture').value;

    			var tradIRAValue = document.getElementById('formNonRothIRAValue').value;
    			var nondeductIRAChecked = document.getElementById('anyNondeductIRA').value;
    			var nondeductIRAValue = document.getElementById('formNondeductibleIRA').value;

    			var convertValue = document.getElementById('formConvertValue').value;
    			var yearsValue = document.getElementById('formYears').value;
    			var interestRateValue = document.getElementById('investIntRate').value;

    			// We need to validate that we have 
    			//var margTaxRateFutureValid = validateInput(margTaxRateFuture,1,50,margTaxRateFutureLabel);

    			// If we have money in both nondeductible IRAs and traditional IRAs, then what is converted to a
    			// Roth IRA needs to be done in a prorated fashion according to the proportions of the two funds
    			// which reduces the tax burden.
    			// Cf. https://www.betterment.com/resources/roth-ira-rules-smart-ways-to-avoid-taxes-on-a-conversion/
    			// Or https://www.bogleheads.org/wiki/Backdoor_Roth_IRA

    			// We'll set prorateTaxFactor = 1.0 and it will reduce if we have nonzero nondeductible IRA values

    			var prorateTaxFactor = 1.0;
    			if (!isNaN(nondeductIRAValue) && nondeductIRAValue > 0 && !isNaN(tradIRAValue) && tradIRAValue > 0) {
    				prorateTaxFactor  = 1.0 - nondeductIRAValue/tradIRAValue;
    				//alert(prorateTaxFactor);
    			}

    			// If we include state taxes, we need to modify the numbers that go into the calculations below

    			var totalTaxRateToday = margTaxRateToday;
    			var totalTaxRateFuture = margTaxRateFuture;
    			if (!isNaN(stateTaxRateToday) && stateTaxRateToday > 0 && !isNaN(stateTaxRateFuture) && stateTaxRateFuture > 0) {
    				totalTaxRateToday  = margTaxRateToday + stateTaxRateToday;
    				totalTaxRateFuture  = margTaxRateFuture + stateTaxRateFuture;    				
    				alert(totalTaxRateToday);
    			}

				if (validateFunction()) {

    			//if (margTaxRateFutureValid) {

	    			// Now we need to calculate the increase in value of each portion

	    			// For the amount converted to the Roth IRA
	    			var finalCalc = FVcalc(convertValue,interestRateValue,yearsValue);
	    			var roth = finalCalc;
	    			//document.getElementById('finalRothIRA').value=finalCalc.toFixed(2).replace(/\d(?=(\d{3})+\.)/g, '$&,');
	    			document.getElementById('finalRothIRA').value=finalCalc.toFixed(2);

	    			// If you left the amount in the traditional IRA and allowed it to compound there
	    			// But then you'll have to pay taxes on this amount
	    			//var trad = finalCalc * (1 - margTaxRateFuture/100);
	    			var trad = finalCalc * (1 - totalTaxRateFuture/100);
	    			//document.getElementById('finalTradIRA').value = trad.toFixed(2).replace(/\d(?=(\d{3})+\.)/g, '$&,');
	    			document.getElementById('finalTradIRA').value = trad.toFixed(2);

	    			// The amount of taxes that need to be paid immediately for the Roth IRA conversion come out of other
	    			// funds. If one does not convert the money to a Roth IRA, then this money could be invested in a
	    			// regular investment account in which taxes apply to the capital gains only.
	    			//var investedTaxes = margTaxRateToday/100*convertValue * prorateTaxFactor;
	    			var investedTaxes = totalTaxRateToday/100*convertValue * prorateTaxFactor;
	    			var netInvTaxes = (FVcalc(investedTaxes,interestRateValue,yearsValue) - investedTaxes) * (1 - 0.15) + investedTaxes;
	    			document.getElementById('finalTaxesIRANonConvert').value=netInvTaxes.toFixed(2);
	/*    			document.getElementById('finalTaxesIRANonConvert').value=netInvTaxes.toFixed(2).replace(/\d(?=(\d{3})+\.)/g, '$&,');*/

					//addData('myChart', [roth, trad]);
					drawBarChart();
				}
        		
			}

			// From https://stackoverflow.com/questions/4712585/calculating-future-value-with-compound-interest-with-javascript
			function FVcalc(PresentAmount,InterestRate,NumberOfYears) {
    			var timescompound = 1; // For just compounding annually
    			var AnnualInterestRate = (InterestRate/100)/timescompound;
    			var Years= NumberOfYears

    			var Periods=timescompound*Years;
    			var NumPayments=Periods;
    			var Prin=PresentAmount;

    			var FutureValue=Math.floor((Prin)*(Math.pow((1+AnnualInterestRate),(Periods)))*100)/100;

    			return FutureValue
			}

		</script>


		<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.7.2/Chart.min.js"></script>

		<script>

			Chart.scaleService.updateScaleDefaults('linear', {
    			ticks: {
        				min: 0
    			}
			});

			function drawBarChart() {
				var ctx = document.getElementById('myChart').getContext('2d');
				var roth = document.getElementById('finalRothIRA').value;
				var trad = document.getElementById('finalTradIRA').value;
				var netInvTaxes = document.getElementById('finalTaxesIRANonConvert').value;
				var chart = new Chart(ctx, {
				    // The type of chart we want to create
				    type: 'bar',

				    // The data for our dataset
				    data: {
				        labels: ["Converted to Roth", "Keep in IRA"],
				        datasets: [{
				            label: "Roth Conversion",
				            backgroundColor: ['rgb(255, 99, 132)','rgb(99, 255, 132)'],
				            borderColor: ['rgb(255, 99, 132)','rgb(99, 255, 132)'],
				            data: [roth, 0]
				            //backgroundColor: ['rgb(255, 99, 132)','rgb(99, 255, 132)'],
				            //borderColor: ['rgb(255, 99, 132)','rgb(99, 255, 132)'],
				            //data: [roth, trad]
				        },

				        {
				            label: "Keep in IRA",
				            backgroundColor: ['rgb(99, 255, 132)','rgb(99, 255, 132)'],
				            borderColor: ['rgb(99, 255, 132)','rgb(99, 255, 132)'],
				            data: [0, trad]
				        },

				        {
				            label: "Roth Conversion Taxes Invested",
				            backgroundColor: ['rgb(99, 132, 255)','rgb(99, 132, 255)'],
				            borderColor: ['rgb(99, 132, 255)','rgb(99, 132, 255)'],
				            data: [0, netInvTaxes]
				        }]
				    },



				    // Configuration options go here
				    options: {
				    	title: {
            				display: true,
            				text: 'Net Funds Available Upon Retirement (in U.S. Dollars)',
            				fontsize: 48
        				},

        				//responsive: true,

				    	scales: {
            				xAxes: [{
                				stacked: true
            				}],
            				yAxes: [{
                				stacked: true
            				}]
        				}

				    }
				});
			}


			function addData(chart, data) {
    			//chart.data.labels.push(label);
    			chart.data.datasets.forEach((dataset) => {
        			dataset.data.push(data);
    				});
    			chart.update();
			}

/*			function addData(chart, label, data) {
    			chart.data.labels.push(label);
    			chart.data.datasets.forEach((dataset) => {
        			dataset.data.push(data);
    				});
    			chart.update();
			}*/
		</script>



		<script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>

		<script>
			function toggler(divId) {
    			$("#" + divId).toggle();
			}
		</script>



		<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>


		<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.2/js/bootstrap.min.js" integrity="sha384-o+RDsa0aLu++PJvFqy8fFScvbHFLtbvScb8AjopnFD+iEQ7wo/CG0xlczd+2O/em" crossorigin="anonymous"></script>

	</body>
</html>